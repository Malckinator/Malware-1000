#ifndef BUS_H
#define BUS_H

#include <stdint.h>
#include <stdbool.h>

typedef uint64_t qword;
typedef uint32_t dword;
typedef uint16_t word;
typedef uint8_t byte;

typedef struct MemoryRegionStruct {
	dword start;
	dword end;
	dword (*read)(struct MemoryRegionStruct*, dword, byte);
	void (*write)(struct MemoryRegionStruct*, dword, dword, byte);
	void* data;
} MemoryRegion;

typedef struct BusStruct {
	MemoryRegion** regions;
	int count;
} Bus;

MemoryRegion* CreateMemoryRegion(dword start, dword end, dword(*read)(MemoryRegion*, dword, byte), void (*write)(MemoryRegion*, dword, dword, byte));
Bus* CreateBus(int count);
dword ReadBus(Bus* bus, dword addr, byte bytes);
void WriteBus(Bus* bus, dword addr, dword data, byte bytes);

#endif